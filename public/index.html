<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GriefMaze.io</title>
    
    <link rel="icon" type="image/png" href="favicon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; user-select: none; }
        
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }

        /* --- TIMERS & ANNOUNCEMENTS --- */
        #game-timer {
            position: absolute; top: 20px; left: 20px; font-size: 32px; font-weight: bold; color: white;
            text-shadow: 2px 2px 0 #000; font-family: monospace; display: none;
        }

        #center-announcement {
            position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%);
            display: none; flex-direction: column; align-items: center; gap: 10px;
            pointer-events: none;
        }
        
        #center-text {
            font-size: 60px; font-weight: 900; color: #fff; text-shadow: 0 0 20px black;
            text-transform: uppercase; text-align: center;
        }

        /* --- CHAT --- */
        #chat-container {
            position: absolute; bottom: 20px; left: 20px; width: 350px; height: 250px;
            display: flex; flex-direction: column; pointer-events: auto; z-index: 50;
        }
        #chat-box {
            flex: 1; overflow-y: auto; background: rgba(0,0,0,0.5); border-radius: 5px 5px 0 0;
            padding: 10px; font-size: 14px; color: white; scrollbar-width: thin;
        }
        #chat-input {
            width: 100%; padding: 10px; background: rgba(0,0,0,0.7); border: none;
            color: white; border-radius: 0 0 5px 5px; font-size: 14px; box-sizing: border-box;
            outline: none; pointer-events: auto;
        }
        #chat-input:focus { background: rgba(0,0,0,0.9); border: 1px solid #555; }
        
        /* Chat Message Styles */
        .chat-msg { margin-bottom: 4px; word-wrap: break-word; }
        .chat-system { color: #ffff00; font-style: italic; }
        .chat-join { color: #00ff00; }
        .chat-leave { color: #ff3333; }
        .chat-player { color: white; }
        .chat-name { font-weight: bold; color: #00ccff; cursor: pointer; text-decoration: underline; }
        .chat-name:hover { color: white; }

        /* --- MENUS --- */
        .menu-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center;
            pointer-events: auto; backdrop-filter: blur(5px); 
            z-index: 200; 
        }

        .menu-box {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            padding: 40px; border-radius: 20px; border: 2px solid #444;
            box-shadow: 0 0 30px rgba(0,0,0,0.8); text-align: center; color: white; width: 500px; position: relative;
        }

        /* --- SIDE PANELS (Common) --- */
        .side-panel {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 360px;
            max-height: 600px;
            background: rgba(0, 0, 0, 0.85);
            border: 1px solid #444;
            border-radius: 10px;
            padding: 20px;
            color: #ddd;
            overflow-y: auto;
            text-align: left;
            font-size: 14px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* --- RIGHT PANEL: CHANGELOG --- */
        #changelog { right: 50px; }
        #changelog h3 { margin-top: 0; color: gold; border-bottom: 1px solid #555; padding-bottom: 10px; }
        .log-entry { margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .log-version { font-weight: bold; color: #00ccff; font-size: 16px; }
        .log-date { font-size: 12px; color: #888; margin-bottom: 5px; }
        .log-list { padding-left: 20px; margin: 5px 0; }
        .log-list li { margin-bottom: 4px; }

        /* --- LEFT PANEL: COMMUNITY & DONATE --- */
        #community-box { left: 50px; text-align: center; }
        #community-box h3 { margin-top: 0; color: #00ff00; border-bottom: 1px solid #555; padding-bottom: 10px; }
        .comm-text { margin-bottom: 20px; color: #ccc; line-height: 1.5; }
        
        /* UPDATED DONATE BUTTON */
        .btn-donate {
            display: block; 
            width: 90%; 
            margin: 15px auto; 
            padding: 12px; 
            font-size: 18px; font-weight: bold;
            color: black; border: none; border-radius: 8px; cursor: pointer;
            background: linear-gradient(to right, #FFD700, #FFA500); 
            box-shadow: 0 4px 0 #b8860b; transition: transform 0.1s;
            text-decoration: none;
            box-sizing: border-box;
        }
        .btn-donate:hover { background: linear-gradient(to right, #ffe066, #ffcc00); }
        .btn-donate:active { transform: translateY(4px); box-shadow: none; }

        .discord-link { color: #7289da; text-decoration: none; font-weight: bold; font-size: 16px; display: block; margin-top: 15px; }
        .discord-link:hover { text-decoration: underline; }

        /* --- GUEST PROMO BOX --- */
        #guest-promo {
            background: linear-gradient(45deg, #ffcc00, #ff9900);
            color: black;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            margin-top: 15px; 
            margin-bottom: 15px;
            position: relative;
            animation: pulse 2s infinite;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
        }
        #guest-promo::after {
            content: "";
            position: absolute;
            bottom: 100%; 
            left: 50%;
            margin-left: -8px;
            border-width: 8px;
            border-style: solid;
            border-color: transparent transparent #ffcc00 transparent;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        .menu-title {
            font-size: 50px; font-weight: 900; margin: 0 0 20px 0;
            background: -webkit-linear-gradient(#ff3333, #ff9933); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-transform: uppercase; letter-spacing: 2px;
        }
        .beta-tag { font-size: 18px; color: gold; font-weight: bold; margin-bottom: 15px; }

        #resume-hint { color: #aaa; font-size: 14px; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; display: none; }
        #lobby-code-display { color: cyan; font-size: 18px; margin-top: 5px; display: none; font-weight: bold; }

        /* General Inputs (Exclude Chat) */
        .menu-box input[type="text"], .menu-box input[type="password"], .menu-box input[type="number"], .modal-content input {
            display: block; margin: 10px auto; width: 80%; padding: 12px; font-size: 18px; border-radius: 8px;
            border: 2px solid #555; background: #111; color: white; text-align: center;
        }

        .btn-large {
            display: block; width: 100%; padding: 15px; font-size: 24px; font-weight: bold;
            color: white; border: none; border-radius: 8px; margin: 10px 0; cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s; text-transform: uppercase;
        }
        
        .btn-play { background: linear-gradient(to right, #28a745, #218838); box-shadow: 0 4px 0 #1e7e34; }
        .btn-host { background: linear-gradient(to right, #007bff, #0069d9); box-shadow: 0 4px 0 #0062cc; }
        .btn-leave { background: linear-gradient(to right, #dc3545, #c82333); box-shadow: 0 4px 0 #bd2130; }
        .btn-play:active, .btn-host:active, .btn-leave:active { transform: translateY(4px); box-shadow: none; }

        .btn-row { display: flex; gap: 10px; margin-top: 10px; }
        .btn-small { flex: 1; padding: 10px; font-size: 16px; background: #444; color: #ddd; border: none; border-radius: 5px; cursor: pointer; transition: background 0.2s; }
        .btn-small:hover { background: #555; }

        /* HOST CONTROLS IN MENU */
        #btn-menu-start { background: #00ff00; color: black; display: none; text-shadow: none; box-shadow: 0 4px 0 #00cc00; }
        #btn-host-restart { background: #ff9900; color: black; display: none; text-shadow: none; box-shadow: 0 4px 0 #cc7a00; }

        /* UNSTUCK BUTTON */
        #btn-unstuck {
            margin-top: 10px; padding: 8px; background: #555; color: #ddd; border: 1px solid #777; border-radius: 5px; cursor: pointer; font-size: 12px; width: 50%; margin-left: auto; margin-right: auto; display: block;
        }
        #btn-unstuck:hover { background: #777; }

        .icon-btn-row { display: flex; justify-content: center; gap: 15px; margin-top: 25px; padding-top: 20px; border-top: 1px solid #444; }
        .icon-btn { background: none; border: none; color: #aaa; font-size: 24px; cursor: pointer; transition: color 0.2s, transform 0.2s; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .icon-btn:hover { color: white; transform: scale(1.1); }

        /* --- MODALS --- */
        .modal {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); justify-content: center; align-items: center; z-index: 300; pointer-events: auto;
        }
        .modal-content {
            background: #222; padding: 30px; border-radius: 15px; border: 1px solid #555;
            width: 600px; max-height: 80%; overflow-y: auto; color: white; text-align: center; position: relative;
        }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; color: #ff3333; }

        .host-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left; margin: 15px 0; }
        .host-label { display: flex; align-items: center; gap: 10px; background: #333; padding: 8px; border-radius: 5px; cursor: pointer; }
        .host-label input { margin: 0; width: auto; }

        /* REPORT MODAL */
        #report-reason { width: 80%; padding: 10px; background: #111; color: white; border: 2px solid #555; border-radius: 5px; margin: 15px auto; display: block; font-size: 16px; }
        #report-details { width: 80%; height: 80px; padding: 10px; background: #111; color: white; border: 2px solid #555; border-radius: 5px; margin: 0 auto 15px auto; display: block; font-family: inherit; resize: none; }

        /* SETTINGS MODAL */
        .settings-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 15px; text-align: right; align-items: center; width: 80%; margin: 20px auto; }
        .settings-grid label { font-size: 18px; color: #ccc; }
        .settings-grid input[type="range"] { width: 100%; cursor: pointer; }

        /* --- LEGEND GRID FIXED --- */
        .legend-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: left; }
        .legend-item { background: #333; padding: 10px; border-radius: 8px; display: flex; align-items: center; gap: 10px; }
        .legend-icon { 
            width: 40px; height: 40px; 
            border-radius: 5px; 
            display: flex; justify-content: center; align-items: center; 
            font-size: 20px; font-weight: bold;
            flex-shrink: 0; 
        }
        .legend-text h4 { margin: 0; color: #fff; }
        .legend-text p { margin: 2px 0 0 0; font-size: 12px; color: #ccc; }

        /* --- HUD --- */
        #minimap { position: absolute; top: 20px; right: 20px; width: 150px; height: 150px; background: rgba(0,0,0,0.5); border: 2px solid rgba(255,255,255,0.5); transition: filter 0.5s; }
        .jammed { filter: blur(8px) contrast(200%) hue-rotate(90deg); }
        #minimap-player { position: absolute; width: 6px; height: 6px; background: lime; border-radius: 50%; transform: translate(-50%, -50%); top: 50%; left: 50%; z-index: 10; }
        .minimap-item { position: absolute; width: 4px; height: 4px; background: #00FFFF; border-radius: 50%; transform: translate(-50%, -50%); }

        .hud-msg {
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%); font-size: 24px; font-weight: bold;
            display: none; background: rgba(0,0,0,0.5); padding: 10px 20px; border-radius: 10px; text-shadow: 2px 2px 0 #000;
        }
        #powerup-hud { color: gold; border: 2px solid gold; }
        #brick-hud { color: #cd5c5c; border: 2px solid #cd5c5c; top: 120px; }
        #trap-hud { color: #32cd32; border: 2px solid #32cd32; top: 120px; }
        #pepper-hud { color: #FF4500; border: 2px solid #FF4500; top: 120px; }
        #blind-hud { color: #cc00ff; border: 2px solid #cc00ff; top: 70px; }
        #blinded-warning { color: red; border: 2px solid red; top: 50%; font-size: 30px; }
        #swap-hud { color: cyan; border: 2px solid cyan; top: 50%; font-size: 40px; background: rgba(0,0,0,0.8); z-index: 50; }
        #trapped-warning { color: #32cd32; border: 2px solid #32cd32; top: 50%; font-size: 30px; z-index: 55; }
        #inverted-warning { color: #9370DB; border: 2px solid #9370DB; top: 30%; font-size: 35px; z-index: 60; }
        #scramble-warning { color: #A9A9A9; border: 2px solid #A9A9A9; top: 150px; font-size: 28px; }
        #feedback-hud { color: #9370DB; border: 2px solid #9370DB; top: 150px; font-size: 20px; }
        #ghost-hud { color: #FF4500; border: 2px solid #FF4500; top: 50%; font-size: 40px; z-index: 70; }
        #fly-hud { bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 16px; color: cyan; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 5px; width: auto; top: auto; }

        .end-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none; justify-content: center; align-items: center; flex-direction: column; color: white; pointer-events: none; z-index: 100; background: rgba(0,0,0,0.9); }
        #result-title { font-size: 60px; font-weight: bold; }
        #leaderboard { margin-top: 20px; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; width: 400px; }
        table { width: 100%; border-collapse: collapse; } th, td { padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.2); text-align: left; }
        #next-round-timer { margin-top: 20px; font-size: 24px; color: yellow; }
        
        #account-btn { background: transparent; border: 1px solid #555; color: #888; padding: 5px 15px; border-radius: 20px; font-size: 14px; margin-bottom: 15px; cursor: pointer; }
        #account-btn:hover { color: white; border-color: white; }
        
        #dev-tag {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: #555;
            font-size: 12px;
            pointer-events: none;
            white-space: nowrap;
        }

        /* --- TAB LIST --- */
        #tab-list {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.85); color: white; padding: 20px; border-radius: 10px;
            display: none; flex-direction: column; gap: 8px; min-width: 350px; text-align: center;
            border: 2px solid #555; z-index: 150; font-family: 'Segoe UI', sans-serif;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
        }
        .tab-header { font-size: 20px; font-weight: bold; border-bottom: 1px solid #666; padding-bottom: 10px; margin-bottom: 5px; color: gold; letter-spacing: 1px; }
        .tab-row { padding: 8px; background: rgba(255,255,255,0.1); border-radius: 5px; display: flex; justify-content: space-between; align-items: center; }
        .tab-me { color: #00ff00; font-weight: bold; text-shadow: 0 0 5px #00ff00; }
        .tab-name { font-size: 16px; }
        .tab-report { cursor: pointer; font-size: 18px; margin-left: 10px; transition: transform 0.2s; }
        .tab-report:hover { transform: scale(1.2); }
    </style>
</head>
<body>

    <div id="game-timer">05:00</div>
    
    <div id="center-announcement">
        <div id="center-text"></div>
    </div>

    <div id="chat-container">
        <div id="chat-box"></div>
        <input type="text" id="chat-input" placeholder="Press Enter to chat..." autocomplete="off">
    </div>

    <div id="tab-list">
        <div class="tab-header" id="tab-header-text">LOBBY PLAYERS</div>
        <div id="tab-content"></div>
    </div>

    <div id="main-menu" class="menu-container">
        <div id="community-box" class="side-panel">
            <h3>COMMUNITY</h3>
            <p class="comm-text">
                Thank you for playing the Beta! <br><br>
                GriefMaze is a solo project. Your support helps keep the servers running. <br><br>
                <strong>Join our Discord</strong> to chat with me (11CHASE11) about bugs, ideas, or just to hang out!
            </p>
            <a href="https://buymeacoffee.com/11chase11" target="_blank" class="btn-donate"><i class="fas fa-coffee"></i> Donate</a>
            <p class="comm-text" style="font-size:12px; margin-top:20px;">
                Found a bug? Use the bug report button on the main menu!
            </p>
            <a href="https://discord.gg/M2jEguu5kp" target="_blank" class="discord-link"><i class="fab fa-discord"></i> Join Discord</a>
        </div>

        <div class="menu-box">
            <div id="resume-hint">(Press ESC to Resume)</div>
            <div class="menu-title">GRIEFMAZE.IO</div>
            <div class="beta-tag">BETA v1.1</div>
            
            <button id="account-btn"><i class="fas fa-user"></i> <span id="account-status">Login / Sign Up</span></button>
            
            <div id="guest-promo">
                Sign in to save stats & win coins! ü™ô
            </div>

            <div id="lobby-code-display">Lobby: <span id="current-lobby-code"></span></div>
            <input type="text" id="name-input" placeholder="Enter Nickname" maxlength="12">
            
            <button id="find-game-btn" class="btn-large btn-play">Find Game</button>
            <button id="host-game-btn" class="btn-large btn-host">Host Game</button>
            
            <button id="btn-menu-start" class="btn-large" style="background:#00ff00; color:black; font-weight:bold; display:none;">START ROUND</button>
            <button id="btn-host-restart" class="btn-large" style="background:#ff9900; color:black; font-weight:bold; display:none;">RESTART GAME</button>
            
            <button id="btn-unstuck">I'm Stuck!</button>
            
            <div class="btn-row">
                <button id="btn-invite" class="btn-small"><i class="fas fa-envelope"></i> Invite</button>
                <button id="btn-join-code" class="btn-small"><i class="fas fa-key"></i> Join Code</button>
            </div>
            <div class="icon-btn-row">
                <button class="icon-btn" id="btn-shop"><i class="fas fa-shopping-cart"></i><span>Shop</span></button>
                <button class="icon-btn" id="btn-customize"><i class="fas fa-tshirt"></i><span>Skins</span></button>
                <button class="icon-btn" id="btn-legend"><i class="fas fa-book"></i><span>Items</span></button>
                <button class="icon-btn" id="btn-settings"><i class="fas fa-cog"></i><span>Settings</span></button>
                <button class="icon-btn" onclick="openBugReport()"><i class="fas fa-bug"></i><span>Bug</span></button>
            </div>
            <div id="dev-tag">Developed by 11CHASE11</div>
        </div>

        <div id="changelog" class="side-panel">
            <h3>Update Log</h3>
            <div class="log-entry">
                <div class="log-version">v1.1 - The Fix Update</div>
                <div class="log-date">Live Now</div>
                <ul class="log-list">
                    <li>Added "I'm Stuck!" button to menu.</li>
                    <li>Fixed getting stuck in walls (Auto-Detect).</li>
                    <li>Fixed Host transfer issues.</li>
                    <li>Fixed Name Duplication (Guest 1, 2...).</li>
                    <li>Fixed Chat Report clicking bugs.</li>
                    <li>Added Chat Message Limit (50).</li>
                    <li>Improved Security & Anti-Cheat.</li>
                </ul>
            </div>
            <div class="log-entry">
                <div class="log-version">v1.0 - Launch</div>
                <div class="log-date">Initial Release</div>
                <ul class="log-list">
                    <li>Multiplayer Maze Gameplay.</li>
                    <li>Accounts, Stats, & Leaderboards.</li>
                    <li>8 Unique Items & Traps.</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="modal-report" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="document.getElementById('modal-report').style.display='none'">&times;</span>
            <h2>Report Player</h2>
            <p id="report-target-name" style="color:cyan; font-weight:bold;"></p>
            <select id="report-reason">
                <option value="Cheating / Hacking">Cheating / Hacking</option>
                <option value="Toxic / Harassment">Toxic / Harassment</option>
                <option value="Griefing / Teaming">Griefing / Teaming</option>
                <option value="Inappropriate Name">Inappropriate Name</option>
                <option value="Other">Other</option>
            </select>
            <textarea id="report-details" placeholder="Additional details (optional)..."></textarea>
            <button id="btn-submit-report" class="btn-large" style="background:#dc3545;">Submit Report</button>
        </div>
    </div>

    <div id="modal-host" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="document.getElementById('modal-host').style.display='none'">&times;</span>
            <h2>Host Private Game</h2>
            <label>Max Players (2-20): <input type="number" id="host-max-players" value="8" min="2" max="20"></label>
            <label>Map Size (21-101): <input type="number" id="host-map-size" value="61" min="21" max="101" step="2"></label>
            <label>Pre-Round Time (sec): <input type="number" id="host-pre-time" value="10" min="0" max="60"></label>
            <p style="font-size:12px; color:#aaa; margin-top:-5px;">(Set to 0 for Manual Start)</p>
            <label>Game Time (sec, 0=Inf): <input type="number" id="host-game-time" value="300" min="0"></label>
            <label class="host-label" style="width:90%;margin:10px auto;"><input type="checkbox" id="host-private"> Private Lobby (Code Only)</label>
            
            <h3>Allowed Items</h3>
            <div class="host-grid">
                <label class="host-label"><input type="checkbox" id="item-boot" checked> Boots</label>
                <label class="host-label"><input type="checkbox" id="item-brick" checked> Brick</label>
                <label class="host-label"><input type="checkbox" id="item-trap" checked> Trap</label>
                <label class="host-label"><input type="checkbox" id="item-pepper" checked> Pepper</label>
                <label class="host-label"><input type="checkbox" id="item-orb" checked> Dark Orb</label>
                <label class="host-label"><input type="checkbox" id="item-swap" checked> Swap</label>
                <label class="host-label"><input type="checkbox" id="item-hindered" checked> Hinder</label>
                <label class="host-label"><input type="checkbox" id="item-scrambler" checked> Scrambler</label>
            </div>
            <button id="btn-start-host" class="btn-large btn-host">Create Lobby</button>
        </div>
    </div>

    <div id="modal-join" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="document.getElementById('modal-join').style.display='none'">&times;</span>
            <h2>Join By Code</h2>
            <input type="text" id="join-code-input" placeholder="Enter 6-Character Code" style="text-transform:uppercase;">
            <button id="btn-submit-code" class="btn-large btn-play">Join</button>
        </div>
    </div>

    <div id="modal-account" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="document.getElementById('modal-account').style.display='none'">&times;</span>
            <h2>Account</h2>
            <input type="text" id="auth-username" placeholder="Username">
            <input type="password" id="auth-password" placeholder="Password">
            <div class="btn-row">
                <button id="btn-do-login" class="btn-small" style="background:#28a745;">Log In</button>
                <button id="btn-do-signup" class="btn-small" style="background:#007bff;">Create Account</button>
            </div>
        </div>
    </div>

    <div id="modal-profile" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="document.getElementById('modal-profile').style.display='none'">&times;</span>
            <h2 id="profile-title">Profile</h2>
            <div class="profile-stat"><span class="profile-label">Coins:</span> <span id="prof-coins">0</span> üí∞</div>
            <div class="profile-stat"><span class="profile-label">Wins:</span> <span id="prof-wins">0</span> üèÜ</div>
            <div class="profile-stat"><span class="profile-label">Games:</span> <span id="prof-games">0</span> üéÆ</div>
            <div class="btn-row" style="margin-top:30px;">
                <button id="btn-logout" class="btn-small" style="background:#666;">Log Out</button>
                <button id="btn-delete-acc" class="btn-small" style="background:#8b0000; color:#ffaaaa;">Delete Account</button>
            </div>
        </div>
    </div>

    <div id="modal-settings" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="document.getElementById('modal-settings').style.display='none'">&times;</span>
            <h2>Settings</h2>
            <div class="settings-grid">
                <label>FOV:</label>
                <input type="range" id="setting-fov" min="60" max="110" value="75">
                <label>Render Dist:</label>
                <input type="range" id="setting-render" min="20" max="200" value="60">
            </div>
            <p id="settings-val-display" style="color:#aaa; font-size:14px;"></p>
        </div>
    </div>

    <div id="modal-legend" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="document.getElementById('modal-legend').style.display='none'">&times;</span>
            <h2>Item Guide</h2>
            <div class="legend-grid">
                <div class="legend-item"><div class="legend-icon" style="background:#FFD700;">üë¢</div><div class="legend-text"><h4>Boots</h4><p>Super Jump (15s).</p></div></div>
                <div class="legend-item"><div class="legend-icon" style="background:#cd5c5c;">üß±</div><div class="legend-text"><h4>Brick</h4><p>Place Wall (Press E).</p></div></div>
                <div class="legend-item"><div class="legend-icon" style="background:#228b22;">üåø</div><div class="legend-text"><h4>Vine Trap</h4><p>Place Trap (Press E).</p></div></div>
                <div class="legend-item"><div class="legend-icon" style="background:#FF0000;">üå∂Ô∏è</div><div class="legend-text"><h4>Ghost Pepper</h4><p>Walk Thru Walls (3s).</p></div></div>
                <div class="legend-item"><div class="legend-icon" style="background:#0000ff;">üîÑ</div><div class="legend-text"><h4>Swap</h4><p>Swap locations.</p></div></div>
                <div class="legend-item"><div class="legend-icon" style="background:#000;">‚ö´</div><div class="legend-text"><h4>Dark Orb</h4><p>Blind others.</p></div></div>
                <div class="legend-item"><div class="legend-icon" style="background:#9370DB;">üß™</div><div class="legend-text"><h4>Hinder Potion</h4><p>Invert controls.</p></div></div>
                <div class="legend-item"><div class="legend-icon" style="background:#808080;">üì°</div><div class="legend-text"><h4>Scrambler</h4><p>Jam minimap.</p></div></div>
            </div>
        </div>
    </div>
    
    <div id="modal-shop" class="modal"><div class="modal-content"><span class="close-btn" onclick="document.getElementById('modal-shop').style.display='none'">&times;</span><h2>Shop</h2><p>Coming Soon...</p></div></div>
    <div id="modal-customize" class="modal"><div class="modal-content"><span class="close-btn" onclick="document.getElementById('modal-customize').style.display='none'">&times;</span><h2>Skins</h2><p>Coming Soon...</p></div></div>

    <div id="round-over-screen" class="end-screen">
        <div id="result-title">ROUND OVER</div>
        <div id="leaderboard"><table><thead><tr><th>Rank</th><th>Name</th><th>Dist</th></tr></thead><tbody id="leaderboard-body"></tbody></table></div>
        <div id="next-round-timer">Next: 15s</div>
    </div>

    <div id="minimap"><div id="minimap-player"></div></div>

    <div id="powerup-hud" class="hud-msg">SUPER JUMP: <span id="timer-val">15</span>s</div>
    <div id="brick-hud" class="hud-msg">BRICK HELD (PRESS 'E')</div>
    <div id="trap-hud" class="hud-msg">VINE TRAP HELD (PRESS 'E')</div>
    <div id="pepper-hud" class="hud-msg">GHOST PEPPER HELD (PRESS 'E')</div>
    <div id="blind-hud" class="hud-msg">DARKNESS UNLEASHED: <span id="blind-atk-timer">15</span>s</div>
    <div id="blinded-warning" class="hud-msg">!!! BLINDED !!! <span id="blind-vic-timer">15</span>s</div>
    <div id="swap-hud" class="hud-msg">üîÑ SWAPPED! üîÑ</div>
    <div id="trapped-warning" class="hud-msg">üåø TRAPPED! üåø <span id="trap-timer">10</span>s</div>
    <div id="inverted-warning" class="hud-msg">üòµ HINDERED! üòµ<br><span style="font-size: 20px;">(Controls Inverted: <span id="inverted-timer">15</span>s)</span></div>
    <div id="scramble-warning" class="hud-msg">üì° RADAR JAMMED! üì°<br><span style="font-size: 20px;">(Signal Lost: <span id="scramble-timer">15</span>s)</span></div>
    <div id="feedback-hud" class="hud-msg">CHAOS UNLEASHED!</div>
    <div id="ghost-hud" class="hud-msg">üëª GHOST MODE üëª<br><span style="font-size: 20px;">(No Clip: <span id="ghost-timer">3</span>s)</span></div>
    <div id="fly-hud" class="hud-msg" style="display:none;">FLYING MODE ACTIVE</div>

    <script src="/socket.io/socket.io.js"></script>
    <script type="importmap">{"imports": {"three": "https://unpkg.com/three@0.160.0/build/three.module.js","three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"}}</script>
    <script type="module" src="./game.js"></script>
    <script>
        function openBugReport() {
            if(window.openBugReport) window.openBugReport();
        }
    </script>
</body>
</html>